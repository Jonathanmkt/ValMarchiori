[
  {
    "transcript": "chegou a hora de você construir com a \ngente um contêiner docker do absoluto \nzero e colocar uma aplicação \ndesenvolvida utilizando nextjs dentro de \num VPS E você vai ficar impressionado \ncomo é que é simples aliás essa junção \nnextjs docker e um VPS é \n[Música] \nexcelente nós já temos por aqui vídeo \nensinando você a colocar sua aplicação \nem nodejs no ar usando pm2 mas quando se \ntrata de flexibilidade usar container é \nsem igual né gente Dessa vez Nós criamos \numa aplicação bem simples usando o \nnextjs e o tailwind CSS e a gente vai \ncriar o nosso docker file do zero então \nse você tem alguma dúvida sobre como \ncriar contêineres Esse vídeo é para você \npor isso se você chegar no fim do vídeo \ne aprender algo novo ou diferente do que \nvocê já faz Deixa aquele tapa no like \nque nós gostamos e também um comentário \nnós estamos usando nesse vídeo Um dos \nnossos VPS da hostinger se você \nacompanha a gente aqui no canal já viu a \ngente falando deles pra gente é o melhor \ncusto benefício que existe pois nós \npodemos ali rodar não só PHP e nodejs \nmas muitas Outras aplicações como Python \ndnet E por aí vai dá para transformar \nseu VPS em um servidor de banco de dados \nVPN e até um gerenciador de contêiners \nvale muito a pena conhecer as soluções \nda rosinger tem para todos os gostos e \nbolsos o painel deles é super simples e \ndescomplicado para gerenciar o seu \nserviços e no VPS você escolhe a \ndistribuição que você quiser e pode \ncriar imagens de backups praticamente \ninstantâneos assim se você precisar \nrestaurar algo você consegue fazer isso \ncom um clique sem dor de cabeça e para \nconseguir ainda mais desconto é só usar \no link que tá aqui na descrição ou usar \no nosso cupom o código fonte com esse \ncupom você terá um desconto aqui do \ncanal em cima do desconto que ele já \nfornecem Então vale muito a pena que a \ngente pode começar vendo justamente a \naplicação que é bem simples e tá rodando \nlocal aqui né no código nós temos aqui ó \nalgumas páginas tá uma galer de fotos e \numa rota dinâmica aqui que eu chamei de \ncor Ou seja é só uma forma da gente \nutilizar alguns recursos do Next na \naplicação então para rodar a gente faz o \nnpm Run \nDev vê que ele tá rodando aqui na porta \n3000 tá \nentão a gente vai modificar isso quando \na gente for utilizar no contêiner ele \ntem aqui uma lista de cores ó dentro de \ndaa eu criei um arquivo com Gradiente e \numa lista aqui é justamente essa lista \nque aparece no menu ó então quando eu \nvou trocando clicando aqui em cada uma \ncada um vira uma rota né Uhum e ele vai \ntrocando aqui a cor e aqui tem uma \ngaleria de fotos com as nossas fotos por \nque que eu usei isso porque o Next \ntambém tem um recurso para otimizar \nimagens né se a gente pegar aqui por \nexemplo essa imagem aqui ó ela tá no \nrepositório como um tamanho real Mas \nvocê vê aqui na URL que ele utiliza a \nfoto como parâmetro para redimensionar \nfazer otimização Então essa é a \naplicação bem simples né sim mas é já é \no suficiente pra gente dizer olha temos \numa aplicação next rodando dentro de um \ndocker e o que que a gente vai precisar \npara rodar o docker Vanessa é muito \nsimples né pessoal fala assim ah a gente \nprecisa de um monte de coisa instalada \nnão você precisa ter o docker instalado \nna máquina claro né mas aí para você \nconfigurar ele criar as imagens dentro \ndo seu projeto a gente precisa de \nsimplesmente uma arquivo mas a gente vai \nusar mais alguns para mostrar de uma \nforma mais robusta Como utilizar então é \no docker file esse aqui que é o é o \nprincipal Então quando você vê esse esse \narquivo na raiz do projeto você sabe que \nvocê consegue rodar esse projeto dentro \nde um contêiner tem o outro que é o \ndocker compose \neemil ele também ele se gerencia os \ncontêiners né e o docker Ignore esse é \ntipo o Git Ignore mais M princípio né É \no mesmo princípio só que pro docker o \ndocker ignor Já coloquei aqui as pastas \nque ele vai ignorar o próprio arquivo do \ndocker que ele ignora né E por assim por \nassim vai o Git e a pasta do Next ou \nseja funciona igualzinho o Git ignor tá \no docker file A gente vai construir na \nmunheca tudo na mão desde o início tá a \ngente tá com o Git Hub copar ativado \nPode ser que ele ajude a gente mas eu \nvou se ele atrapalhar a gente desativa é \nentão eu vou colocar assim Olha vou \nbotar até comentário pra gente tá etapa \num \nconstrução e a etapa dois vai ser a \nexecução Ó lá ele até colocou Qual é a \nideia a gente vai criar duas imagens a \ngente é inédito isso aqui a gente já \nusou em vários vídeos o docker Mas a \ngente nunca usou dessa forma então uma \nforma um pouco diferente para você poder \ncriar as suas imagens primeiro eu vou \ncorrigir aqui digi errado primeiro a \ngente vai criar uma imagem e ela vai \nfazer o Build do projeto e ela vai ter \nlá os arquivos certinhos do build quando \na gente tá usando nex ele cria uma pasta \nchamada pon e o build da aplicação fica \ntoda lá então aquilo ali já é o \nsuficiente para rodar a aplicação então \ncom essa pasta a gente vai criar uma \noutra imagem E aí vamos copiar de uma \nimagem para outra e aí sim a gente vai \nrodar o projeto então a ideia aqui ó é \njustamente rodar um node Tá eu vou \ncolocar aqui o 18 \nisso eu vou chamar ele de \nbuilder Então esse aqui que é a que é a \nmãe aqui ó dessa imagem e aí eu vou \ncolocar um work \ndear normalmente eu boto aqui um um app \nbom aí o que que eu preciso pra gente \npoder usar o npm né já que ele já tem \numa imagem do node ele já vai tá tudo \ncom isso pronto se eu copiar o Packet \nJason pra pasta app eu já consigo fazer \num npm install sim eu vou colocar aqui o \no o package Lock também ó e aí eu \nsimplesmente rodo o comando npm install \nbem simples aí a aplicação já vai ter \ntodas as dependências ali só que a gente \nnão tem ainda a pasta da aplicação então \na gente precisa copiar né aqui nesse \ncaso ele vai copiar tudo aqui ó o Source \nPublic né tudo que eu tenho \naqui obviamente ignorando aqui o docker \nign né e copiando para dentro da parte \nda APP então nisso aqui eu já consigo \nfazer o build com o Next então ele roda \naqui e faz um build uma boa prática aí é \na gente rodar o comando também para \nexcluir as dependências de \ndesenvolvimento né porque senão fica \nmuita coisa desnecessária né exatamente \nPois é ainda mais se a gente for rodar \nvários containers ele tem que ser bem \nleve mesmo em relação mais limpo \npossível não precisa carregar nada de \nnecessário Então imagina a gente Us \nmuita dependência de desenvolvimento e \nquando a gente tem o o o projeto lá em \nBuild a gente não tem necessidade mais \ndisso né então justamente aqui a gente \nusa o npm prun aí o traço traço \nproduction então é aquele Dev \ndependencies que fica ali né no Packet \nJason aqui nesse caso aqui ó a gente tem \ntrês tá vendo ó typescript node react \nentão com isso aqui a gente já tem o \nprojeto pronto para rodar só que ele não \nvai rodar nessa imagem gente vai criar \numa outra olha só vamos usar aqui o node \npin de novo o workd vou chamar de app \ntambém e aqui a gente vai copiar \njustamente os arquivos que a gente \nprecisa olha qual é a ideia a gente roda \no comando copy justamente como tá ali ó \ne ele vai usar o builder como origem né \nmas aqui a gente não vai usar esse dis \nnada disso ó então a a gente vai colocar \no Packet Jason eu vou colocar separado \ntá \nporque dessa forma assim ó não confunde \nentão a gente pode usar o o pack Jon \nLock o node \nmoduls nesse caso aqui eu vou usar \ntambém a quer dizer eu tenho que usar né \na pasta do Next porque ela sim é que tem \na aplicação toda lá né inclusive \ndependendo da configuração você nem \nprecisa do node modul sabia com a essa \npasta aqui do nex ele já leva tudo mas \nnesse caso aqui a gente vai deixar a \ngente pode configurar também o arquivo \ndo Next levar ele né pro projeto arquivo \nde configuração do Next aqui eu posso \ncolocar só assim ó e a gente tem essa \npasta Public justamente onde tem as \nimagens Então essa a gente também vai \ncopiar e agora aqui a gente pode também \nrodar o comando npm \nInstall e nesse caso aqui a gente vai \nfazer de outra forma pra gente remover \nas dependências de desenvolvimento a \ngente vai colocar só o only production \ntá vendo é uma outra outra forma também \nde rodar vamos expor a porta 3030 é uma \noutra porta e no fim a gente dá o npm \nstart que é justamente esse script aqui \nesse script ó para rodar o o Next na \nporta \n3030 npm start no docker compos a gente \nfez assim ó a gente criou um serviço a \ngente não vai criar volumes a gente até \npoderia depois configurar volume tem \noutros contêiners sei lá banco de dados \nné tem todo um que a gente já mostrou \nisso também em outros vídeos mas aqui \nnesse caso a gente só vai precisar de um \nserviço que vai ser o docker no docker \nFire que a gente criou a gente vai \nchamar ele de app next e a gente vai \nusar a porta interna 30 e expor a porta \n30 30 e expor a porta 30 30 também então \no nosso docker composto tá bem simples e \na configuração quando o contêiner se ele \nder se ele der algum erro você pode \nconfigurar para ele ficar \nreiniciando nesse caso ele só vai \nreiniciar ou parar né justamente Quando \neu der um Stop então mesmo se der erro \nele vai ele vai ficar lá com erro isso é \né bom pra gente poder inspecionar se se \nder algum problema agora que a gente vai \nver se vai funcionar mesmo ó eu tô \nusando Windows e eu tenho já o docker \ninstalado então primeiro eu posso \nconstruir a imagem eu tô na pasta eu tô \nna pasta do projeto então o docker file \ntá lá então ele já sabe qual é o a \nimagem né que ele vai usar então se eu \ncolocar docker build e eu posso colocar \naqui app next e o ponto que é a pasta \natual e o appn é o nome aí da da imagem \nque ele vai \nconstruir então você vê que ele vai \nexecutar todas as etapas que a gente \ncriou dentro do docker file ó lá work \ndear tá vendo Então a gente consegue ver \ntudo e aí quando ele tá rodando o Build \na gente consegue ver também o processo \nde Build do próprio \nnext pronto acabou deixa tirar aqui ó só \nque a gente vê que ele só criou imagem \ntem aqui vendo mas ele não tem o coner \nnão temer ainda rodando pra gente subir \noer a gente pode usar o docker \ncompose a gente poderia usar o próprio \ndocker mes docker poderar docker Run \nficar a porta ó e assim ó 30 30 30 30 \nporque isso eu especifiquei no docker \ncompos né mas dá para especificar nesse \ncaso e eu boto aqui o appn ou o nome que \neu quero para esse contêiner mas eu não \nvou rodar assim eu vou rodar através do \ndocker compose então eu uso o docker \ncompose da mesma forma que eu construí \ncom o docker build eu posso fazer isso \ntambém com docker compos eu poderia \ncolocar assim ó docker compose build por \nexemplo ele baixa a imagem e já já roda \nné Então nesse caso eu vou fazer docker \ncompose up men D esse Men D aqui é o \nseguinte ele vai começar a rodar o \ncontêiner e ele vai desatar ou seja não \nvou ficar com terminal preso né que é a \nideia então aparentemente Já Deu Tudo \nCerto Deixa eu subir aqui para vocês \nverem aqui tá deixa eu zerar Agora se a \ngente olhar o contêiner já tá rodando ó \nentão local aqui na minha máquina se eu \nacessar agora não a porta 3000 mas a \nporta 30 eu tenho aplicação já rodando \nvia container tá \nvendo legal né se eu quiser inspecionar \nesse contêiner eu consigo também a gente \ntem aqui por exemplo código aqui né do \ncontêiner né o token dele o ID Se eu \ncolocar por exemplo docker exec dá para \nfazer isso pelo vs code também tá e \ncolocar o id e botar um sh eu tenho aqui \nacesso ao Shell dentro do do docker \nentão se eu quiser ver poxa será que ele \ncopiou os arquivos certinhos será tá \ntudo OK eu consigo ver por aqui se eu \nlistar aqui ó já tem a pasta next tá \nvendo tá tá tudo bonitinho aqui e tá \nrodando porque eu tô vendo que o a \naplicação tá rodando então funcionou \nagora por exemplo se eu quiser \ninspecionar os logs né se eu não quiser \nAh não quero ver o Shell mas eu quero \nver o que que aconteceu quando o rodou \nné eu posso colocar assim ó docker logs \nMen F E aí eu coloco o nome do contêiner \nEsse foi o que mostrou no terminal do \ncontêiner né quando ele startou a \naplicação tá vendo agora que deu tudo \ncerto local a gente pode partir pro VPS \nda hostinger e eu coloquei todo esse \ncódigo que a gente fez lá num \nrepositório no meu github tá disponível \nse você quiser fazer exatamente como eu \ntô fazendo pode fazer também tem lá o \nendereço vou deixar aqui na descrição do \nvídeo por que que a gente vai usar o \ngithub a gente vai clonar esse projeto \npara dentro do \nVPS coloco aqui o nome da pasta que eu \nquero criar \ne foi se a gente entrar aqui ó já tá \ntodo o projeto lá com os arquivos né \ndocker file e o docker \ncompose eu já tenho o docker instalado \naqui e como a gente tá usando uma \ndistribuição Linux pode mudar de uma \ndistribuição para outra a forma de como \nvocê instala Então você vai ter que ir \natrás disso para ver como faz né \ndependendo do painel que você instalar \nna Hoster você pode instalar o docker \npelo próprio painel tá não tem aí é bem \nsimples né um clique ele já tá instalado \na gente pode ver aqui por exemplo ó não \ntem nenhum contêiner ainda então a gente \nvamos construir a imagem como a gente \nfez local usando aqui o menus T eu vou \nchamar também de app next e como \nreferência a pasta atual aqui que a \ngente tá usando da \naplicação eu vou esconder a gente aqui ó \nsó para você ver aqui o processo todo \nrolando \nnão deu \nerro vamos ver agora deixa eu limpar a \ntela vamos usar então o docker \ncompose Up e com aquele parâmetro menos \nD A princípio tudo bem deixa eu ver aqui \nó docker PS já temos aqui a porta 30 30 \nrolando então se a gente pegar pelo IP \ndo servidor e colocar na porta 3030 vai \nfuncionar eu acho é para ser é para ser \nvamos ver \na A então isso quer dizer o seguinte que \no docker eh expôs a porta 3030 e essa \nporta tá acessível pelo IP né ó vamos \nver que se tá funcionando direitinho \ntudo funcionando ó lá beleza mas o que \nacontece a gente pode também a gente não \nvai mostrar aqui porque a gente já \nmostrou em outro vídeo em parceria com a \nhostinger a gente configurando o proxy \nreverso ou seja se a gente configurar um \nproxy com um domínio ou um subdomínio \nnosso a gente pode apontar para esse \nendereço 3030 internamente no servidor \nEntão nesse caso por exemplo eu criei \naqui um subdomínio é o Next pcod \nfonte.tv então ele já tá aponta pra \naplicação né aponta pro contener e a \naplicação que tá rodando nela \nó Então já tá funcionando direitinho e \naí e nesse caso você pode configurar do \njeito que você quiser E aí curtiu diz \naqui nos comentários se você vai tentar \nesse tipo de abordagem para colocar as \nsuas aplicações em produção Lembrando \nque se você quiser atualizar \nautomaticamente a sua aplicação a partir \ndo github Você vai precisar configurar \numa Action e nós já temos vídeo \nensinando a fazer isso aqui tá mas se \nvocê quiser ver esse tipo de conteúdo \npara esse tipo de aplicação é só pedir \naqui nos comentários que a gente prepara \num exclusivamente para você se você \nquiser também que a gente mostre \nnovamente como faz para configurar um \nprox reverso como a gente fez aí no \nvídeo também diz aqui nos comentários e \nnão esqueça de conferir o Descontão que \na gente tem para você aqui na hostinger \ntá aqui o link tá na descrição aproveita \no o cupom código fonte e a gente se vê \nno próximo vídeo até lá tchau tchau \ntchau tchau \n[Música] \n[Música] \nC \n[Música] \n"
  }
]